language: csharp
dist: trusty
matrix:
  include:
    - dotnet: 2.1.300
      mono: none
      env: DOT_NET="Core"
    - dotnet: 2.1.300
      mono: latest
      env: DOT_NET="Framework"

install:
  - if [ "$DOT_NET" == "Framework" ]; then nuget restore ./Maoli/Maoli.csproj; fi
  - if [ "$DOT_NET" == "Framework" ]; then nuget restore ./Maoli.Net462.Tests/Maoli.Net462.Tests.csproj -PackagesDirectory ..\packages; fi
  - if [ "$DOT_NET" == "Framework" ]; then nuget install xunit.runners -Version 1.9.2 -OutputDirectory testrunner; fi
 
script:
  - if [ "$DOT_NET" == "Framework" ]; then cd Maoli; fi
  - if [ "$DOT_NET" == "Framework" ]; then dotnet build; fi
  - if [ "$DOT_NET" == "Framework" ]; then cd ..; fi
  - if [ "$DOT_NET" == "Framework" ]; then xbuild /p:Configuration=Release ./Maoli.Net462.Tests/Maoli.Net462.Tests.csproj; fi
  - if [ "$DOT_NET" == "Framework" ]; then mono ./testrunner/xunit.runners.1.9.2/tools/xunit.console.clr4.exe ./Maoli.Net462.Tests/bin/Release/Maoli.Net462.Tests.dll; fi

  - if [ "$DOT_NET" == "Core" ]; then cd Maoli.NetCoreApp20.Tests; fi
  - if [ "$DOT_NET" == "Core" ]; then dotnet restore; fi
  - if [ "$DOT_NET" == "Core" ]; then dotnet test; fi
